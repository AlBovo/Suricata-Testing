alert http any any -> any any (msg:"SURICATA Web Shell Upload Detected";flow:established,to_server;http.uri; content:".php";http.request_body; content:"eval("; content:"base64_decode";distance:0; within:100;classtype:web-application-attack;sid:1000011; rev:1;)
alert tcp any any -> any any (msg:"SURICATA Nmap Stealth Scan Detected";flags:S;threshold: type both, track by_src, count 5, seconds 10;sid:1000012; rev:1;)
alert http any any -> any any (msg:"SURICATA Windows Executable Download Detected";flow:established,to_client;file.magic; content:"executable for MS Windows";sid:1000014; rev:1;)
alert http any any -> any any (msg:"SURICATA Web Server Enumeration Attempt Detected";urilen:>100;threshold: type both, track by_src, count 10, seconds 60;sid:1000015; rev:1;)
alert http any any -> any any (msg:"SURICATA Directory Traversal Attempt Detected";flow:established,to_server;content:"../";http_uri;classtype:web-application-attack;sid:1000016; rev:1;)
alert http any any -> any any (msg:"SURICATA Command Injection Attempt Detected";flow:established,to_server;content:"\;";http_uri;classtype:web-application-attack;sid:1000017; rev:1;)
alert http any any -> any any (msg:"SURICATA SSRF Attempt Detected";flow:established,to_server;content:"127.0.0.1";http_uri;classtype:web-application-attack;sid:1000018; rev:1;)
alert tcp any any -> any any (msg:"SURICATA Nmap Version Scan Detected";flags:SA;sid:1000019; threshold: type both, track by_src, count 5, seconds 10; rev:1;)
alert tcp any any -> any ![80,8080] (msg:"SURICATA HTTP Traffic on Non-Standard Port Detected";flow:to_server;app-layer-protocol:http;sid:1000020; rev:1;)
alert icmp any any -> any any (msg:"SURICATA SMURF attack detected"; itype:8; threshold: type threshold, track by_src, count 5, seconds 10; sid:1000021; rev:2;)
alert http any any -> any any (msg:"SURICATA HTTP Request smuggling Detected in POST request"; flow:established,to_server; content:"Content-Length"; http_header; nocase; content:"Transfer-Encoding"; http_header; nocase; content:"POST"; http_method; nocase; sid:12345; rev:1;)
alert http any any -> any any (msg:"SURICATA HTTP Request smuggling Detected in GET request"; flow:established,to_server; content:"Content-Length"; http_header; nocase; content:"Transfer-Encoding"; http_header; nocase; content:"GET"; http_method; nocase; sid:12346; rev:1;)


alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg: "SURICATA OT unknown service is trying to reach internal network"; flow: to_server; threshold:type limit, track by_src, count 1, seconds 10; flags: S; sid: 1000022; rev: 1;)
alert ip $UNKNOWN_DEVICES any -> any any (msg: "SURICATA OT unknown device in HOME_NET is trying to reach other devices"; sid: 1000023; rev: 1;)
alert tcp any any -> $HOME_NET any (msg: "SURICATA OT known vulnerability is possibly being exploited"; pcre:"/%[pns]/"; sid: 1000024; rev: 1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 44818 (msg: "SURICATA OT known tcp port for plc used by an external device"; sid: 1000025; rev: 1;)
alert udp $EXTERNAL_NET any -> $HOME_NET 2222 (msg: "SURICATA OT known udp port for plc used by an external device"; sid: 1000026; rev:1;)
alert ip $EXTERNAL_NET any -> $HOME_NET any (msg:"SURICATA OT too many packets to same internal IP:Port, possible DDOS attack"; flow:to_server; threshold:type both, track by_dst, count 50, seconds 10; sid:1000027; rev:1;)
alert ip $HOME_NET any -> $EXTERNAL_NET any (msg:"SURICATA OT too many packets to same external IP:Port, possible botnet compromise"; flow:to_server; threshold:type both, track by_dst, count 50, seconds 10; sid:1000028; rev:1;)

alert tcp any any -> $KNOWN_DEVICES 502 (msg:"SURICATA OT MODBUS reconfiguration instructions (write single coil) are being sent to known devices"; content:"|05|"; offset:7; depth:1; sid:1000029; rev:1;)
alert tcp any any -> $KNOWN_DEVICES 502 (msg:"SURICATA OT MODBUS reconfiguration instructions (write multiple coils) are being sent to known devices"; content:"|10|"; offset:7; depth:1; sid:1000030; rev:1;)
alert tcp any any -> $KNOWN_DEVICES 20000 (msg:"SURICATA OT DNP3 direct operate sent to known devices"; content:"|05|"; offset:15; depth:1; sid:1000031; rev:1;)
alert tcp any any -> $KNOWN_DEVICES 20000 (msg:"SURICATA OT DNP3 select/operate sent to known devices"; content:"|06|"; offset:15; depth:1; sid:1000032; rev:1;)
alert udp any any -> $HOME_NET 47808 (msg:"SURICATA OT BACNET whois flood attack detected"; content:"|08|"; offset:7; depth:1; threshold: type threshold, track by_dst, count 50, seconds 30; sid:1000033; rev:1;)
alert udp any any -> $HOME_NET 47808 (msg:"SURICATA OT BACNET readproperty suspicious request found"; content:"|0c|"; offset:7; depth:1; sid:1000034; rev:1;)
alert tcp any any -> $KNOWN_DEVICES 102 (msg:"SURICATA OT Siemens S7 write variable detected"; content:"|05|"; offset:10; depth:1; sid:1000035; rev:1;)
